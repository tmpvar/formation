(function(a){function i(a,b){!a||(a.unselectable=b?"off":"on",a.onselectstart=function(){return b},a.style&&(a.style.MozUserSelect=b?"":"none"))}function h(){return d.dragging===!1}function g(a){return Math.pow(a,2)}function f(b,c,d){b.type=c;var e=a.event.handle.call(d,b);return e===!1?!1:e||b.result}function e(h){var j=this,k,l=h.data||{};if(l.elem)j=h.dragTarget=l.elem,h.dragProxy=d.proxy||j,h.cursorOffsetX=l.pageX-l.left,h.cursorOffsetY=l.pageY-l.top,h.offsetX=h.pageX-h.cursorOffsetX,h.offsetY=h.pageY-h.cursorOffsetY;else if(d.dragging||l.which>0&&h.which!=l.which||a(h.target).is(l.not))return;switch(h.type){case"mousedown":a.extend(l,a(j).offset(),{elem:j,target:h.target,pageX:h.pageX,pageY:h.pageY}),b.add(document,"mousemove mouseup",e,l),i(j,!1),d.dragging=null;return!1;case!d.dragging&&"mousemove":if(g(h.pageX-l.pageX)+g(h.pageY-l.pageY)<l.distance)break;h.target=l.target,k=f(h,"dragstart",j),k!==!1&&(d.dragging=j,d.proxy=h.dragProxy=a(k||j)[0]);case"mousemove":if(d.dragging){k=f(h,"drag",j),c.drop&&(c.drop.allowed=k!==!1,c.drop.handler(h));if(k!==!1)break;h.type="mouseup"};case"mouseup":b.remove(document,"mousemove mouseup",e),d.dragging&&(c.drop&&c.drop.handler(h),f(h,"dragend",j)),i(j,!0),d.dragging=d.proxy=l.elem=!1}return!0}a.fn.drag=function(a,b,c){b&&this.bind("dragstart",a),c&&this.bind("dragend",c);return a?this.bind("drag",b?b:a):this.trigger("drag")};var b=a.event,c=b.special,d=c.drag={not:":input",distance:0,which:1,dragging:!1,setup:function(c){c=a.extend({distance:d.distance,which:d.which,not:d.not},c||{}),c.distance=g(c.distance),b.add(this,"mousedown",e,c),this.attachEvent&&this.attachEvent("ondragstart",h)},teardown:function(){b.remove(this,"mousedown",e),this===d.dragging&&(d.dragging=d.proxy=!1),i(this,!0),this.detachEvent&&this.detachEvent("ondragstart",h)}};c.dragstart=c.dragend={setup:function(){},teardown:function(){}}})(jQuery),function(a){function f(){var a=0,b,c,e=[d.event.pageX,d.event.pageY],g=d.locate(d.event.dragProxy);d.tolerance=d.tolerance||d.modes[d.mode];do if(b=d.data[a])c=d.tolerance?d.tolerance.call(d,d.event,g,b):d.contains(b,e)?b:null;while(++a<d.data.length&&!c);d.event.type=(c=c||d.best)?"dropstart":"dropend",(d.event.type=="dropend"||c.elem!=d.dropping)&&d.handler.call(c?c.elem:d.dropping,d.event),d.last&&e[0]==d.last.pageX&&e[1]==d.last.pageY?delete d.timer:d.timer=setTimeout(f,d.delay),d.last=d.event,d.best=null}function e(a,c,d){a.type=c;var e=b.handle.call(d,a);return e===!1?!1:e||a.result}a.fn.drop=function(a,b,c){b&&this.bind("dropstart",a),c&&this.bind("dropend",c);return a?this.bind("drop",b?b:a):this.trigger("drop")},a.dropManage=function(a){a=a||{},d.data=[],d.filter=a.filter||"*",d.delay=a.delay||d.delay,d.tolerance=a.tolerance||null,d.mode=a.mode||d.mode||"intersect";return d.$targets.filter(d.filter).each(function(){d.data[d.data.length]=d.locate(this)})};var b=a.event,c=b.special,d=c.drop={delay:100,mode:"intersect",$targets:a([]),data:[],setup:function(){d.$targets=d.$targets.add(this),d.data[d.data.length]=d.locate(this)},teardown:function(){var b=this;d.$targets=d.$targets.not(this),d.data=a.grep(d.data,function(a){return a.elem!==b})},handler:function(a){var b=null,c;a.dropTarget=d.dropping||undefined;if(d.data.length&&a.dragTarget)switch(a.type){case"drag":d.event=a,d.timer||(d.timer=setTimeout(f,20));break;case"mouseup":d.timer=clearTimeout(d.timer);if(!d.dropping)break;d.allowed&&(c=e(a,"drop",d.dropping)),b=!1;case d.dropping&&"dropstart":b=b===null&&d.allowed?!0:!1;case d.dropping&&"dropend":e(a,"dropend",d.dropping),d.dropping=null,c===!1&&(a.dropTarget=undefined);if(!b)break;case d.allowed&&"dropstart":a.dropTarget=this,d.dropping=e(a,"dropstart",this)!==!1?this:null}},locate:function(b){var c=a(b),d=c.offset(),e=c.outerHeight(),f=c.outerWidth();return{elem:b,L:d.left,R:d.left+f,T:d.top,B:d.top+e,W:f,H:e}},contains:function(a,b){return(b[0]||b.L)>=a.L&&(b[0]||b.R)<=a.R&&(b[1]||b.T)>=a.T&&(b[1]||b.B)<=a.B},modes:{intersect:function(a,b,c){return this.contains(c,[a.pageX,a.pageY])?c:this.modes.overlap.apply(this,arguments)},overlap:function(a,b,c){c.overlap=Math.max(0,Math.min(c.B,b.B)-Math.max(c.T,b.T))*Math.max(0,Math.min(c.R,b.R)-Math.max(c.L,b.L)),c.overlap>((this.best||{}).overlap||0)&&(this.best=c);return null},fit:function(a,b,c){return this.contains(c,b)?c:null},middle:function(a,b,c){return this.contains(c,[b.L+b.W/2,b.T+b.H/2])?c:null}}}}(jQuery)